\documentclass[12pt,twoside]{article}
\usepackage{jmlda}
\usepackage{mathtools}
\usepackage{lineno}
\usepackage{setspace}
\linenumbers
\doublespacing
%\NOREVIEWERNOTES
\title
    [Прогнозирование намерений]
    {Прогнозирование намерений. Исследование свойств локальных моделей при пространственном декодировании сигналов головного мозга.}
\author
    [Болоболова~Н.\,А.]
    {Шиянов~В.\,А., Болоболова~Н.\,А., Самохина~А.\,М., Мокруполо~М.\,Н.}
\thanks
    {Работа выполнена при финансовой поддержке РФФИ, проект \No\,00-00-00000.
    Научный руководитель:  Стрижов~В.\,В.
    Задачу поставил: Стрижов~В.\,В.
    Консультант: Исаченко~Р.\,О.}
\email
    {nataboll@mail.ru}
%\organization
%    {$^1$Организация; $^2$Организация}
\abstract
    {В данной работе исследуются механизмы регуляции движения конечностей нейронами головного мозга. Проверяется гипотеза о влиянии перемещения зон активности нейронов на траекторию движения конечности. Высокая размерность признакового пространства сигналов приводит к неустойчивости модели машинного обучения. Сигнал высокой размерности предлагается аппроксимировать локальной моделью, что существенно уменьшает размерность пространства параметров. Пространство параметров локальной модели используется как признаковое пространство. Таким образом, результирующая модель становится проще и устойчивее. В задаче используются данные электрокортикограмм, собранные на основе исследований активности нейронов головного мозга обезьян.    	

\bigskip
\textbf{Ключевые слова}: \emph{Brain-Computer Interface (BCI), feature engineering}.}
\begin{document}
\maketitle
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\maketitleSecondary

\section{Введение}
Нейрокомпьютерный интерфейс (Brain Computer Interface) \cite{Morishita2014} позволяет восстановить мобильность людей с нарушениями двигательных функций.  Алгоритм BCI транслирует сигналы нейронов головного мозга в команды для исполняющей системы \cite{Morishita2014}. Это дает возможность регулировать движение роботизированной конечности в соответствии с механизмами нервной регуляции. \cite{Donoghue2008}. 


В последнее время большое количество работ посвящено методам считывания мозговой активности и декодирования информации \cite{Hu2018}\cite{Song2017}\cite{Loza2017}\cite{Eliseyev2016}\cite{Gaglianese2016}\cite{Bundy2016}\cite{Morishita2014}.
В этой работе используются данные сигналов, полученных инвазивным методом электрокортикографии (ECoG) \cite{Sirven2014}. Сложность декодирования заключается в избыточной размерности сигнала. Модель прогнозирования намерений является неустойчивой. Также к нестабильности модели приводит наличие сторонних шумов, накладывающихся на сигналы в естественной среде: импульсов других долей головного мозга и сигналов из внешней среды.  Для построения системы нейрокомпьютерного интерфейса необходимо использовать простую и устойчивую модель. 


Исследование состоит в восстановлении зависимостей между сигналами ECoG и движениями конечностей. Для точного предсказания траектории движения в трехмерном пространстве требуется снизить размерность признакового пространства и снизить влияние шумов на предсказания.


Стандартные подходы состоят в извлечении информативных признаков из пространственных, частотных и временных характеристик сигнала\cite{Morishita2014}\cite{Alexander2013}. Большинство методов в смежных работах исследуют частотные характеристики\cite{Chin2007}, \cite{Eliseyev2014}, \cite{Loza2017}. В работах \cite{Eliseyev2016}\cite{Motrenko2018} рассматриваются все признаки вне зависимости от их природы. Наиболее распространёнными моделями являются алгоритмы PLS\cite{Rosipal2006}\cite{Eliseyev2016}, PCA\cite{Zhao2010},\cite{Song2017}. В работах \cite{Zhao2014} используются алгоритмы, построенные на скрытых марковских моделях. В  работах \cite{Loza2017}\cite{Song2017} авторы рассматривают различные участки сигнала как слова. В работе \cite{Motrenko2018} исследован метод отбора признаков с помощью квадратичного программирования (Quadratic Programming Feature Selection \cite{rodriguez2010quadratic}). Результаты работ недостаточно устойчивы по отношению к шумовым сигналам из-за больших вариаций амплитуд \cite{Eliseyev2014},\cite{Song2017}, несмотря на рассмотренные в этих работах механизмы пространственной фильтрации сигналов.


В данной работе для моделирования фронта распределения сигнала предлагается использовать локальную модель. Движение фронта возбуждения приближается с помощью локальной модели прогнозирования движений. В качестве признакового описания объектов используются параметры построенной локальной модели. Полученный  метод значительно снижает размерность данных, использует пространственную информацию и сохраняет свойства распространения сигнала.
Как следствие, количество параметров конечной модели значительно уменьшается. Получается более простая аппроксимация сигнала высокой размерности и более устойчивая прогностическая модель.


В эксперименте используются данные с сайта neurotycho.org. Сбор данных производился с использованием методики Multi-Dimensional Recording. Запись сигналов ECoG и траектории движения руки проводилась одновременно. Каждый из экспериментов длился 15 минут, первые 8 минут производилась запись обучающей выборки, оставшиеся 7 минут - запись тестовой выборки. \\\\


\section{Постановка задачи}
Исходные данные - отрезки многомерных временных рядов электрокортикограммы. Пусть $\mathbf{X} \in \mathbb{R}^{T \times N \times F}$ – массив значений напряжения, где $N$ – число каналов, $T$ – время, $F$ – дискретный спектр наблюдаемых частот. Необходимо построить информативное признаковое пространство для предсказания траектории движения конечности. \\
Исходные данные представлены в виде массивов:
\begin{equation}
\mathbf{X} = \{x_{tji}\}_{t=1,\dots,T;\ \ j=1,\dots,N;\ \ i=1,\dots,F};
\end{equation} 
\begin{equation}
\mathbf{Y} = \{y_{tji}\}_{t=1,\dots,T;\ \ j=1,2,3;\ \ i=1,\dots,F};
\end{equation}
где $\mathbf{X}$ - набор сигналов, $\mathbf{Y}$ - массив ответов. Объектом будем называть матрицу $\mathbf{x}_t$ c измерениями в каждый отрезок времени, $i = 1,\dots,T$. Матрица состоит из $N$ строк, каждая из которых соответствует каналу. Элемент $x_{tji}$ строки $x_{tj}$ содержит значение напряжения на $i$-й частоте. Значение $y_{tji}$ отвечает $j$-й координате траектории движения конечности на $i$-й частоте, соответствующей объекту $\mathbf{x}_t$.\\
Модель прогнозирования $f:\mathbf{X}\to\mathbf{\hat{Y}}$ предлагается искать классе суперпозиции двух моделей: $f(\mathbf{X})=h(g(\mathbf{X}, \mathbf{\Theta}), \mathbf{w})$. Здесь $\mathbf{\hat{Y}}$ - предсказания модели $f$ для обучающей выборки $\mathbf{X}$. Локальная модель $g:\mathbf{X}\times\mathbf{\Theta}\to\mathbf{X}$. использует локальную пространственную структуру сигнала для аппроксимации перемещения фронта возбуждения.
 Примером локальной модели является модель авторегрессии:
\begin{equation}
\left(\begin{array}{@{}c|ccc@{}}
x_{t+1,j,i} & x_{t,j,i}   & \cdots & x_{t-d,j,i}   \\
x_{t,j,i}   & x_{t-1,j,i} & \cdots & x_{t-d-1,j,i} \\
\cdots     & \cdots     & \cdots & \cdots	\\
x_{T_{ji},j,i}   & \cdots     & \cdots & \cdots   \\
\end{array}\right)
\begin{pmatrix}
\theta_1^{ji} \\
\theta_2^{ji} \\
\cdots \\
\theta_d^{ji}
\end{pmatrix}.
\end{equation}
В данной постановке модель $g(\mathbf{X}, \mathbf{\Theta})$ решает задачу оптимизации параметров $\mathbf{\Theta}^{ji}$ для одного временного ряда $\mathbf{x_{ji}}$. Будем рассматривать модель $G: \mathbf{X}\times\mathbf{\Theta}\to\mathbf{X}$, выход которой $\mathbf{\Theta}$ строится как совокупность выходов $g$: $\{\mathbf{\Theta}^{ji}\}_{ji}$. Параметры модели $G(\mathbf{X}, \mathbf{\Theta})$ используются как новое признаковое пространство $\mathbf{\Theta}\in\mathbb{R}^{T\times d}$.
Примером модели $h(\mathbf{w}, \mathbf{\Theta}): \mathbf{\Theta}\to\mathbf{\hat{Y}}$ является модель линейной регрессии с параметрами $\mathbf{w}$. На этапе применения модели $h(\mathbf{w}, \mathbf{\Theta})$ построенное признаковое описание $\mathbf{\Theta}$ используется для предсказания траекторий $\mathbf{\hat{Y}}$.
Параметры $\mathbf{w}$ модели $h(\mathbf{w}, \mathbf{\Theta})$ находятся путем минимизации функции потерь $L(\mathbf{X}, \mathbf{Y}, \mathbf{w}, g, h)$:
\begin{equation}
\mathbf{w^*} = \argmin_{\mathbf{w}} L(\mathbf{X}, \mathbf{Y}, \mathbf{w}, g, h).
\end{equation}
В качестве функции потерь можно выбрать, например, квадратичную ошибку:
\begin{equation}
L(\mathbf{Y}, \mathbf{\hat{Y}}) = \|\mathbf{Y}_j-\mathbf{\hat{Y}}_j\|^2_2.
\end{equation}
Цель работы состоит в нахождении оптимальной локальной модели $g(\mathbf{\Theta}, \mathbf{X})$ для построения информативного признакового пространства.

\section{Выбор локальной модели}
Активность нейронов представляет собой временные вспышки сигналов различной интенсивности, их суперпозицию и распространение. Каждый канал имеет доступ к сигналам некоторого количества нейронов, находящихся в небольшой области пространства. Каждый нейрон соединен с помощью множества отростков с приблизительно 20 тысячами других нейронов. Таким образом, нейроны и связи между ними образуют граф, описывающий возможные пути распространения сигналов. Точно учесть локальную структуру графа при описании сигнала невозможно, так как это потребует большого количества вычислительных ресурсов. В связи с этим предлагается модель локальной аппроксимации формы и перемещения фронта. На изображениях [которые сейчас у Алины и будут тут позже, если все это не окажется бессмысленным бредом] можно заметить, что фронт перемещается по сети в большинстве случаев как единое целое, при этом интенсивность сигнала максимальна в центре множества активных узлов и убывает к периферии. У такой структуры сигнала есть возможное объяснение, основанное на устройстве нейронной сети. Нейрон имеет большое количество небольших отростков - дендритов, основной функцией которых является передача возбуждения к телу нейрона извне, и обычно один аксон, служащий для передачи импульса от тела другим нейронам или мышечной ткани. Получается, что импульсы собираются от периферии к центру каждого нейрона, после чего суммарный импульс, если он достаточно велик, передается по аксону дальше. С помощью первого предположения можно объяснить распределение интенсивности в пределах группы нейронов, а с помощью второго - направленное перемещение пика интенсивности. Эти утверждения можно применить не только к одному нейрону, но и к небольшой совокупности нейронов, если считать интенсивностью сигнала такой совокупности суммарную интенсивность. В связи с эти выдвигается гипотеза, что интенсивность сигнала подчиняется модели нормального распределения: $\mathbf{I} \in N(\mathbf{m}(t),\mathbf{\Sigma}(t))$, где $\mathbf{I}\in\mathbb{R}^N$ - вектор интенсивностей, каждая компонента которого соответствует одному из $N$ каналов. Математическое ожидание $\mathbf{m}(t)$ аппроксимирует положение пика интенсивности в момент времени $t$, а ковариационная матрица $\mathbf{\Sigma}(t)$ описывает форму фронта. Можно рассмотреть случай одинаково распределенных $I_i$, $i=1,\dots,N$. Если предположить дополнительно, что на распределение интенсивности в пределах группы нейронов влияет направленное распространение сигнала внутри группы, можно выдвинуть гипотезу $I_i \in \Gamma(k, \Theta)$, $i=1,\dots,N$, так как гамма-распределение не является симметричным. Предлагается проверить обе гипотезы экспериментально.
%\linenumbers
\bibliographystyle{plain}
\bibliography{../Project17}

\end{document}
